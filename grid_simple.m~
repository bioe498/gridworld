
n_walks = 1000;
n_steps = 100;

%% Gridworld

%       1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16
A = [   0   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0;  % 1
        1   0   1   0   0   1   0   0   0   0   0   0   0   0   0   0;  % 2
        0   1   0   1   0   0   1   0   0   0   0   0   0   0   0   0;  % 3
        0   0   1   0   0   0   0   1   0   0   0   0   0   0   0   0;  % 4
        1   0   0   0   0   1   0   0   1   0   0   0   0   0   0   0;  % 5
        0   1   0   0   1   0   1   0   0   1   0   0   0   0   0   0;  % 6
        0   0   1   0   0   1   0   1   0   0   1   0   0   0   0   0;  % 7
        0   0   0   1   0   0   1   0   0   0   0   1   0   0   0   0;  % 8
        0   0   0   0   1   0   0   0   0   1   0   0   1   0   0   0;  % 9
        0   0   0   0   0   1   0   0   1   0   1   0   0   1   0   0;  % 10
        0   0   0   0   0   0   1   0   0   1   0   1   0   0   1   0;  % 11
        0   0   0   0   0   0   0   1   0   0   1   0   0   0   0   1;  % 12
        0   0   0   0   0   0   0   0   1   0   0   0   0   1   0   0;  % 13
        0   0   0   0   0   0   0   0   0   1   0   0   1   0   1   0;  % 14
        0   0   0   0   0   0   0   0   0   0   1   0   0   1   0   1;  % 15
        0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1]; % 16

N = size(A,1);
P = probmat(A,2);

V = zeros(N,1);
nv = zeros(N,1);

[V,nv] = update_values(V,nv,P,n_walks,n_steps,N);
Pstar = update_policy(V,A);

title('Gridworld')
% subplot(1,3,1)
% plot_grid(N,1:N,A);
% subplot(1,3,2)
% plot_grid(N,round(V,1));
% subplot(1,3,3)
% plot_grid(N,[],Pstar)

ax1 = nexttile;
plot_grid(N,1:N,A);
ax2 = nexttile;
plot_grid(N,round(V,1));
ax3 = nexttile;
plot_grid(N,[],Pstar)

linkaxes([ax1 ax2


%% Gridworld with barriers

%       1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16
A = [   0   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0;  % 1
        1   0   1   0   0   1   0   0   0   0   0   0   0   0   0   0;  % 2
        0   1   0   1   0   0   1   0   0   0   0   0   0   0   0   0;  % 3
        0   0   1   0   0   0   0   1   0   0   0   0   0   0   0   0;  % 4
        1   0   0   0   0   1   0   0   1   0   0   0   0   0   0   0;  % 5
        0   1   0   0   1   0   1   0   0   1   0   0   0   0   0   0;  % 6
        0   0   1   0   0   1   0   0   0   0   1   0   0   0   0   0;  % 7
        0   0   0   1   0   0   0   0   0   0   0   1   0   0   0   0;  % 8
        0   0   0   0   1   0   0   0   0   1   0   0   1   0   0   0;  % 9
        0   0   0   0   0   1   0   0   1   0   1   0   0   0   0   0;  % 10
        0   0   0   0   0   0   1   0   0   1   0   0   0   0   0   0;  % 11
        0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   1;  % 12
        0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0;  % 13
        0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0;  % 14
        0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1;  % 15
        0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1]; % 16

N = size(A,1);
P = probmat(A,2);

V = zeros(N,1);
nv = zeros(N,1);

[V,nv] = update_values(V,nv,P,n_walks,n_steps,N);
Pstar = update_policy(V,A);

subplot(1,3,1)
plot_grid(N,1:N,A);
subplot(1,3,2)
plot_grid(N,V);
subplot(1,3,3)
plot_grid(N,[],Pstar)


%% Gridworld with barriers and tunnel

%       1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16
A = [   0   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0;  % 1
        1   0   1   0   0   1   0   0   0   0   0   0   0   0   0   0;  % 2
        0   1   0   1   0   0   1   0   0   0   0   0   0   0   0   0;  % 3
        0   0   1   0   0   0   0   1   0   0   0   0   0   0   0   0;  % 4
        1   0   0   0   0   1   0   0   1   0   0   0   0   0   0   0;  % 5
        0   1   0   0   1   0   1   0   0   1   0   0   0   0   0   0;  % 6
        0   0   1   0   0   1   0   0   0   0   1   0   0   0   0   0;  % 7
        0   0   0   1   0   0   0   0   0   0   0   1   0   0   0   0;  % 8
        0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0;  % 9
        0   0   0   0   0   1   0   0   1   0   1   0   0   0   0   0;  % 10
        0   0   0   0   0   0   1   0   0   1   0   0   0   0   0   0;  % 11
        0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   1;  % 12
        0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0;  % 13
        0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0;  % 14
        0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1;  % 15
        0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1]; % 16

N = size(A,1);
P = probmat(A,2);

V = zeros(N,1);
nv = zeros(N,1);

[V,nv] = update_values(V,nv,P,n_walks,n_steps,N);
Pstar = update_policy(V,A);

subplot(1,3,1)
plot_grid(N,1:N,A);
subplot(1,3,2)
plot_grid(N,V);
subplot(1,3,3)
plot_grid(N,[],Pstar)
